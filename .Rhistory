#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
#
# FOR: Backbone preprocessing
# Antonia Bott (antonia.bott@uni-hamburg.de)
# Version: 0.5
#
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
# This script
# (1) reads questionnaire data exported from LimeSurvey and calculates sum/mean scores
# (2) reads WCST data and calculates outcome variables
#     (reversals, trials to first reversal, number of errors, perseveration errors)
# (3) reads BACS data and calculates outcome variables
#      (number of answered items, number of correct answers, number of errors)
# (4) reads LNS data and calculates outcome variables
#     (number of correct answers)
# Note:
# For the script to run you should have a main folder (set as working directory) containing two sub folders called data_questionnaires and
# data_tasks (containing subfolders wcst, BACS and LNS).
# In order to access the relevant data, the script specifies the specific subfolders within their respective sections.
# You can use the given structure - or you need to adapt the script to your folder structure below.
# Clean up R environment
rm(list=ls())
cat("\014")
# SETTINGS SECTION--------------------------------------------------------------
## 1) Set your working directory (by adding your Sys.info() output to switch() function)
##    (valuable in case you work on multiple systems and/or collaborate)
### Specify the path to your preferred directory on your system
#path <- '/this/should/lead/to/the/Data/Folder'
### System name
whoami <- Sys.info()[[4]]; print(whoami)
switch(whoami,
"TASCHENRECHNER" = {name <- "C:/Users/anton/";
path <- "OneDrive/03_Projects/ESinRCT/"},
"KOPSY-D-033080" = {name <- "C:/Users/Antonia Bott/";
path <- "OneDrive/03_Projects/ESinRCT/"},
"REAKTOR" = {name <- "C:/Users/Toni/";
path <- "OneDrive/03_Projects/ESinRCT/"},
"Macbook-Lucia.fritz.box" = {name <- "/Users/luciafrohn/";
path <- "Documents/Psychologie/Klinischer Job/FOR/R_Auswertung/"},
"dhcp-172-21-5-162.wlan.uni-hamburg.de.local" = {name <- "/Users/luciafrohn/";
path <- "Documents/Psychologie/Klinischer Job/FOR/R_Auswertung/"}
)
path
switch(whoami,
"TASCHENRECHNER" = {name <- "C:/Users/anton/";
path <- "OneDrive/03_Projects/ESinRCT/"},
"KOPSY-D-033080" = {name <- "C:/Users/Antonia Bott/";
path <- "OneDrive/03_Projects/ESinRCT/"},
"REAKTOR" = {name <- "C:/Users/Toni/";
path <- "OneDrive/03_Projects/ESinRCT/"},
"Macbook-Lucia.fritz.box" = {name <- "/Users/luciafrohn/";
path <- "Documents/Psychologie/Klinischer Job/FOR/R_Auswertung/"},
"dhcp-172-21-5-162.wlan.uni-hamburg.de.local" = {name <- "/Users/luciafrohn/";
path <- "Documents/Psychologie/Klinischer Job/FOR/R_Auswertung/"}
)
script_dir <- dirname(rstudioapi::getSourceEditorContext()$path)
script_dir
switch(whoami,
"TASCHENRECHNER" = {name <- "C:/Users/anton/";
path <- "OneDrive/03_Projects/ESinRCT/"},
"KOPSY-D-033080" = {name <- "C:/Users/Antonia Bott/";
path <- "OneDrive/03_Projects/ESinRCT/"},
"REAKTOR" = {name <- "C:/Users/Toni/";
path <- "OneDrive/03_Projects/ESinRCT/"},
"Macbook-Lucia.fritz.box" = {name <- "/Users/luciafrohn/";
path <- "Documents/Psychologie/Klinischer Job/FOR/R_Auswertung/"},
"dhcp-172-21-5-162.wlan.uni-hamburg.de.local" = {name <- "/Users/luciafrohn/";
path <- "Documents/Psychologie/Klinischer Job/FOR/R_Auswertung/"},
"UN-LAP-015977" = {name <- "C:/Users/bbf7366/"}
# Get the directory of the currently running script
path <- dirname(rstudioapi::getSourceEditorContext()$path)
whoami = "TASCHENRECHNER"
switch(whoami,
"TASCHENRECHNER" = {name <- "C:/Users/anton/";
path <- "OneDrive/03_Projects/ESinRCT/"},
"KOPSY-D-033080" = {name <- "C:/Users/Antonia Bott/";
path <- "OneDrive/03_Projects/ESinRCT/"},
"REAKTOR" = {name <- "C:/Users/Toni/";
path <- "OneDrive/03_Projects/ESinRCT/"},
"Macbook-Lucia.fritz.box" = {name <- "/Users/luciafrohn/";
path <- "Documents/Psychologie/Klinischer Job/FOR/R_Auswertung/"},
"dhcp-172-21-5-162.wlan.uni-hamburg.de.local" = {name <- "/Users/luciafrohn/";
path <- "Documents/Psychologie/Klinischer Job/FOR/R_Auswertung/"},
"UN-LAP-015977" = {name <- "C:/Users/bbf7366/"}
# Get the directory of the currently running script
path <- dirname(rstudioapi::getSourceEditorContext()$path)
whoami<- Sys.info()[[4]]; print(whoami)
switch(whoami,
"UN-LAP-015977" = {name <- "C:/Users/bbf7366/";
path <- dirname(rstudioapi::getSourceEditorContext()$path)},
)
path
file.path(path + raw_data)
file.path(path, "raw_data")
switch(whoami,
"UN-LAP-015977" = {name <- "C:/Users/bbf7366/";
path <- dirname(rstudioapi::getSourceEditorContext()$path)
path = file.path(path, "raw_data")},
)
file_adults <-"results_adults_07042025.csv"
file_adolescents <- "results-survey585676.csv"
file_children <- "results-survey798916.csv"
dat_adults <- read.csv(paste0(name,path, file_adults))
# adult data
# create data sets for each project
for (i in c(0:9, 99)) {
assign(paste0("data_adults_p_", i), subset(dat_adults, project == i))
}
# adolescent data
# create data sets for each project
for (i in c(0:9, 99)) {
assign(paste0("data_adolescents_p_", i), subset(dat_adolescents, project == i))
}
dat_adolescents <- read.csv(paste0(name,path, file_adolescents))
dat_adolescents
file_adolescents <- "results-survey585676.csv"
file_children <- "results-survey798916.csv"
file_adolescents
# adolescent data
# create data sets for each project
for (i in c(0:9, 99)) {
assign(paste0("data_adolescents_p_", i), subset(dat_adolescents, project == i))
}
dat_adolescents <- read.csv(paste0(name,path, file_adolescents))
path
whoami<- Sys.info()[[4]]; print(whoami)
switch(whoami,
"KOPSY-D-033080" = {name <- "K:/vol2011/bba3488/";
path <- "FOR/"},
"UN-LAP-015977" = {name <- dirname(rstudioapi::getSourceEditorContext()$path);
path = file.path("raw_data")}
)
file_adolescents <- "results-survey585676.csv"
file_children <- "results-survey798916.csv"
file_adults <-"results_adults_07042025.csv"
dat_adults <- read.csv(paste0(name,path, file_adults))
dat_adolescents <- read.csv(paste0(name,path, file_adolescents))
file_adolescents <- "results-survey585676.csv"
file_children <- "results-survey798916.csv"
dat_adolescents <- read.csv(file.path(name,path, file_adolescents))
dat_children <- read.csv(file.path(name,path, file_children))
file_adults <-"results_adults_07042025.csv"
dat_adults <- read.csv(file.path(name,path, file_adults))
dat_adolescents
# adolescent data
# create data sets for each project
for (i in c(0:9, 99)) {
assign(paste0("data_adolescents_p_", i), subset(dat_adolescents, project == i))
}
file_adults <-"results_adults_564757.csv"
file_adolescents <- "results-survey585676.csv"
file_children <- "results-survey798916.csv"
dat_adults <- read.csv(file.path(name,path, file_adults))
file_adults <- "results-survey564757.csv"
file_adolescents <- "results-survey585676.csv"
file_children <- "results-survey798916.csv"
dat_adults <- read.csv(file.path(name,path, file_adults))
dat_adolescents <- read.csv(file.path(name,path, file_adolescents))
dat_children <- read.csv(file.path(name,path, file_children))
for (i in c(0:9, 99)) {
assign(paste0("data_adults_p_", i), subset(dat_adults, project == i))
}
c(0:9, 99)
paste0("data_adults_p_", i)
View(dat_adults)
for (i in c(0:9, 99)) {
assign(paste0("data_adults_p_", i), subset(dat_adults, Projekt == i))
}
# adult data
# create data sets for each project
for (i in c(0:9, 99)) {
assign(paste0("data_adults_p_", i), subset(dat_adults, "Projekt" == i))
}
dat_adults$Projekt
class(dat_adults$Projekt)
dat_adults$Projekt(1)
dat_adults$Projekt[1]
dat_adults$Projekt[1] == 7
subset(dat_adults, "Projekt" == i)
for (i in c(0:9, 99)) {
assign(paste0("data_adults_p_", i), subset(dat_adults, Projekt == i))
}
for (i in c(0:9, 99)) {
nm  <- paste0("data_adults_p_", i)
obj <- dat_adults[dat_adults[["Projekt"]] == i, , drop = FALSE]
assign(nm, obj)
}
dat_adults[dat_adults[["Projekt"]] == i
]
dat_adults[["Projekt"]]
dat_adults
names(dat_adults)
"Projekt" %in% names(dat_adults)
"Projekt." %in% names(dat_adults)
for (i in c(0:9, 99)) {
assign(paste0("data_adults_p_", i), subset(dat_adults, "Projekt." == i))
}
subset(dat_adults, "Projekt." == i)
test =  subset(dat_adults, "Projekt." == i)
dat_adults$Projekt.
dat_adults$Projekt. == 7
idx <- c(0:9, 99)
for (i in idx) {
assign(
paste0("data_adults_p_", i),
dat_adults[ dat_adults[["Projekt."]] == i, , drop = FALSE ]
)
}
sapply(c(0:9, 99), function(i) nrow(get(paste0("data_adults_p_", i))))
# adolescent data
# create data sets for each project
for (i in idx) {
assign(
paste0("data_adolescents_p_", i),
dat_adolescents[ dat_adolescents[["Projekt."]] == i, , drop = FALSE ]
)
}
# chlidren data
# create data sets for each project
for (i in idx) {
assign(
paste0("data_children_p_", i),
dat_children[ dat_children[["Projekt."]] == i, , drop = FALSE ]
)
}
View(data_children_p_9)
View(data_adolescents_p_9)
View(data_adolescents_p_99)
View(data_adolescents_p_0)
View(data_adolescents_p_5)
str(dat_adults$Projekt.)
unique(dat_adults$Projekt.)
View(data_adults_p_0)
View(dat_adults)
View(data_adolescents_p_3)
parts  <- split(dat_adults, dat_adults$Projekt.)   # keys are the integer values (as names)
wanted <- as.character(c(0:9, 99))                 # split names are characters
list2env(setNames(parts[wanted], paste0("data_adults_p_", wanted)), .GlobalEnv)
View(data_adults_p_9)
View(data_adults_p_99)
View(data_adults_p_3)
View(data_adults_p_3)
View(data_adults_p_0)
parts  <- split(dat_adolescents, dat_adolescents$Projekt.)   # keys are the integer values (as names)
wanted <- as.character(c(0:9, 99))                 # split names are characters
list2env(setNames(parts[wanted], paste0("data_adolescents_p_", wanted)), .GlobalEnv)
parts_adolescents <- split(dat_adolescents, dat_adolescents$Projekt.)
list2env(
setNames(parts_adolescents[idx_chr], paste0("data_adolescents_p_", idx_chr)),
.GlobalEnv
)
idx_chr <- as.character(c(0:9, 99))
parts_adolescents <- split(dat_adolescents, dat_adolescents$Projekt.)
list2env(
setNames(parts_adolescents[idx_chr], paste0("data_adolescents_p_", idx_chr)),
.GlobalEnv
)
parts_adults <- split(dat_adults, dat_adults$Projekt.)
list2env(
setNames(parts_adults[idx_chr], paste0("data_adults_p_", idx_chr)),
.GlobalEnv
)
View(data_adults_p_8)
dat_adolescents
View(dat_adolescents)
parts_children <- split(dat_children, dat_children$Projekt.)
list2env(
setNames(parts_children[idx_chr], paste0("data_children_p_", idx_chr)),
.GlobalEnv
)
View(data_adults_p_9)
